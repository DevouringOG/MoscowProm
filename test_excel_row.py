"""Test parsing of a single Excel row to debug column mapping."""

# Sample row from Excel (semicolon-separated)
sample_row = """20;7706901234;ООО "СВЕТОТЕХНИКА";ОБЩЕСТВО С ОГРАНИЧЕННОЙ ОТВЕТСТВЕННОСТЬЮ "СВЕТОТЕХНИКА";Действующее;Активное;Действующее;30.06.2022;г. Москва, ул. Ивантеевская, д. 23;г. Москва, ул. Ивантеевская, д. 23;;Электротехника;Производство светотехнической продукции;Электротехника;Производство светильников;Имеется;27.40;Производство электрических ламп и осветительного оборудования;27.40.1;Производство электрических ламп и источников света;Производство светодиодных светильников и ламп для промышленного и бытового применения;Среднее;Среднее;Среднее;Среднее;Среднее;Среднее;13.04.2012;Куликов Андрей Николаевич;ГК "ЭЛЕКТРОСВЕТ";7702345678;Дочернее общество;+7 (495) 612-45-78;kulikov.an@svetotekhnika.ru;Яковлев Максим Игоревич, инженер-электрик;+7 (495) 612-45-79;+7 (495) 612-45-80, Семенов П.К.;www.svetotekhnika-led.ru;info@svetotekhnika.ru;Субсидия на НИОКР 2023;Энергоэффективность А++;Собственная;Да;Нет;Да;Контракт с ЖКХ Москвы;;645670;734560;845670;778900;945670;1123450;1334560;67890;82340;101230;89670;118900;145670;178900;223;245;267;256;289;312;345;223;245;267;256;289;312;345;156780;189340;223450;212340;256780;301340;356780;156780;189340;223450;212340;256780;301340;356780;58.6;64.4;69.7;69.1;74.0;80.5;86.2;58.6;64.4;69.7;69.1;74.0;80.5;86.2;71230;84560;101230;93450;112340;134560;159670;189670;13578;16468;20246;17934;23780;29134;35780;42340;4890;5230;5560;5890;6340;6780;7230;7680;2450;2580;2690;2810;3010;3210;3410;3610;48670;58890;70560;65340;79450;93450;109670;129890;289;334;378;423;478;534;589;645;644;868;1126;1353;1843;2131;2660;2986;0;0;0;0;0;0;0;0;56780;73450;94560;89670;108900;134560;159670;189670;Производственная база;77:11:0005078:2456;9670;Производственная деятельность;Собственность;ООО "СВЕТОТЕХНИКА";77:11:0005078:3789;7890;Производственное здание;Производственный цех;Собственность;ООО "СВЕТОТЕХНИКА";6340;Светодиодные лампы, LED светильники, прожекторы, уличные фонари, ленты LED;ГОСТ Р 54815-2011;Лампы LED E27, светильники офисные, прожекторы светодиодные, светильники уличные;27.40.11.110, 27.40.12.110, 27.40.32.110;Светотехническая продукция / LED лампы / Светильники / Прожекторы;Имеется;Да;75%;Да;189.67;Беларусь, Казахстан, Армения, Киргизия, Узбекистан;8539 50, 9405 10, 9405 40;Активное участие;Электротехника;55.867890, 37.645678;55.867890, 37.645678;;55.867890;37.645678;СВАО;Ростокино"""

# Headers from your list
headers_text = """№;ИНН;Наименование организации;Полное наименование организации;Статус СПАРК;Статус внутренний;Статус ИТОГ;Дата добавления в реестр;Юридический адрес;Адрес производства;Адрес дополнительной площадки;Основная отрасль;Подотрасль (Основная);Дополнительная отрасль;Подотрасль (Дополнительная);Отраслевые презентации;Основной ОКВЭД (СПАРК);Вид деятельности по основному ОКВЭД (СПАРК);Производственный ОКВЭД;Вид деятельности по производственному ОКВЭД;Общие сведения об организации;Размер предприятия (итог);Размер предприятия (итог) 2022;Размер предприятия (по численности);Размер предприятия (по численности) 2022;Размер предприятия (по выручке);Размер предприятия (по выручке) 2022;Дата регистрации;Руководитель;Головная организация;ИНН головной организации;Вид отношения головной организации;Контактные данные руководства;Почта руководства;Контакт сотрудника организации;Номер телефона;Контактные данные ответственного по ЧС;Сайт;Электронная почта;Данные о мерах поддержки;Наличие особого статуса;Площадка итог;Получена поддержка от г. Москвы;Системообразующее предприятие;Статус МСП;То самое ;Финансово-экономические показатели; Выручка предприятия, тыс. руб. 2017 ; Выручка предприятия, тыс. руб. 2018 ; Выручка предприятия, тыс. руб. 2019 ; Выручка предприятия, тыс. руб. 2020 ; Выручка предприятия, тыс. руб. 2021 ; Выручка предприятия, тыс. руб. 2022 ;Выручка предприятия, тыс. руб. 2023; Чистая прибыль (убыток),тыс. руб. 2017 ; Чистая прибыль (убыток),тыс. руб. 2018 ; Чистая прибыль (убыток),тыс. руб. 2019 ; Чистая прибыль (убыток),тыс. руб. 2020 ; Чистая прибыль (убыток),тыс. руб. 2021 ; Чистая прибыль (убыток),тыс. руб. 2022 ; Чистая прибыль (убыток),тыс. руб. 2023 ; Среднесписочная численность персонала (всего по компании), чел 2017 ; Среднесписочная численность персонала (всего по компании), чел 2018 ; Среднесписочная численность персонала (всего по компании), чел 2019 ; Среднесписочная численность персонала (всего по компании), чел 2020 ; Среднесписочная численность персонала (всего по компании), чел 2021 ; Среднесписочная численность персонала (всего по компании), чел 2022 ; Среднесписочная численность персонала (всего по компании), чел 2023 ; Среднесписочная численность персонала, работающего в Москве, чел 2017 ; Среднесписочная численность персонала, работающего в Москве, чел 2018 ; Среднесписочная численность персонала, работающего в Москве, чел 2019 ; Среднесписочная численность персонала, работающего в Москве, чел 2020 ; Среднесписочная численность персонала, работающего в Москве, чел 2021 ; Среднесписочная численность персонала, работающего в Москве, чел 2022 ; Среднесписочная численность персонала, работающего в Москве, чел 2023 ; Фонд оплаты труда всех сотрудников организации, тыс. руб 2017 ; Фонд оплаты труда всех сотрудников организации, тыс. руб 2018 ; Фонд оплаты труда всех сотрудников организации, тыс. руб 2019 ; Фонд оплаты труда всех сотрудников организации, тыс. руб 2020 ; Фонд оплаты труда всех сотрудников организации, тыс. руб 2021 ; Фонд оплаты труда всех сотрудников организации, тыс. руб 2022 ; Фонд оплаты труда всех сотрудников организации, тыс. руб 2023 ; Фонд оплаты труда  сотрудников, работающих в Москве, тыс. руб 2017 ; Фонд оплаты труда  сотрудников, работающих в Москве, тыс. руб 2018 ; Фонд оплаты труда  сотрудников, работающих в Москве, тыс. руб 2019 ; Фонд оплаты труда  сотрудников, работающих в Москве, тыс. руб 2020 ; Фонд оплаты труда  сотрудников, работающих в Москве, тыс. руб. 2021 ; Фонд оплаты труда  сотрудников, работающих в Москве, тыс. руб. 2022 ; Фонд оплаты труда  сотрудников, работающих в Москве, тыс. руб. 2023 ; Средняя з.п. всех сотрудников организации,  тыс.руб. 2017 ; Средняя з.п. всех сотрудников организации,  тыс.руб. 2018 ; Средняя з.п. всех сотрудников организации,  тыс.руб. 2019 ; Средняя з.п. всех сотрудников организации,  тыс.руб. 2020 ; Средняя з.п. всех сотрудников организации,  тыс.руб. 2021 ; Средняя з.п. всех сотрудников организации,  тыс.руб. 2022 ; Средняя з.п. всех сотрудников организации,  тыс.руб. 2023 ; Средняя з.п. сотрудников, работающих в Москве,  тыс.руб. 2017 ; Средняя з.п. сотрудников, работающих в Москве,  тыс.руб. 2018 ; Средняя з.п. сотрудников, работающих в Москве,  тыс.руб. 2019 ; Средняя з.п. сотрудников, работающих в Москве,  тыс.руб. 2020 ; Средняя з.п. сотрудников, работающих в Москве,  тыс.руб. 2021 ; Средняя з.п. сотрудников, работающих в Москве,  тыс.руб. 2022 ; Средняя з.п. сотрудников, работающих в Москве,  тыс.руб. 2023 ; Налоги, уплаченные в бюджет Москвы (без акцизов), тыс.руб. 2017 ; Налоги, уплаченные в бюджет Москвы (без акцизов), тыс.руб. 2018 ; Налоги, уплаченные в бюджет Москвы (без акцизов), тыс.руб. 2019 ; Налоги, уплаченные в бюджет Москвы (без акцизов), тыс.руб. 2020 ; Налоги, уплаченные в бюджет Москвы (без акцизов), тыс.руб. 2021 ; Налоги, уплаченные в бюджет Москвы (без акцизов), тыс.руб. 2022 ; Налоги, уплаченные в бюджет Москвы (без акцизов), тыс.руб. 2023 ; Налоги, уплаченные в бюджет Москвы (без акцизов), тыс.руб. 2024 ; Налог на прибыль, тыс.руб. 2017 ; Налог на прибыль, тыс.руб. 2018 ; Налог на прибыль, тыс.руб. 2019 ; Налог на прибыль, тыс.руб. 2020 ; Налог на прибыль, тыс.руб. 2021 ; Налог на прибыль, тыс.руб. 2022 ; Налог на прибыль, тыс.руб. 2023 ; Налог на прибыль, тыс.руб. 2024 ; Налог на имущество, тыс.руб. 2017 ; Налог на имущество, тыс.руб. 2018 ; Налог на имущество, тыс.руб. 2019 ; Налог на имущество, тыс.руб. 2020 ; Налог на имущество, тыс.руб. 2021 ; Налог на имущество, тыс.руб. 2022 ; Налог на имущество, тыс.руб. 2023 ; Налог на имущество, тыс.руб. 2024 ; Налог на землю, тыс.руб. 2017 ; Налог на землю, тыс.руб. 2018 ; Налог на землю, тыс.руб. 2019 ; Налог на землю, тыс.руб. 2020 ; Налог на землю, тыс.руб. 2021 ; Налог на землю, тыс.руб. 2022 ; Налог на землю, тыс.руб. 2023 ; Налог на землю, тыс.руб. 2024 ; НДФЛ, тыс.руб. 2017 ; НДФЛ, тыс.руб. 2018 ; НДФЛ, тыс.руб. 2019 ; НДФЛ, тыс.руб. 2020 ; НДФЛ, тыс.руб. 2021 ; НДФЛ, тыс.руб. 2022 ; НДФЛ, тыс.руб. 2023 ; НДФЛ, тыс.руб. 2024 ; Транспортный налог, тыс.руб. 2017 ; Транспортный налог, тыс.руб. 2018 ; Транспортный налог, тыс.руб. 2019 ; Транспортный налог, тыс.руб. 2020 ; Транспортный налог, тыс.руб. 2021 ; Транспортный налог, тыс.руб. 2022 ; Транспортный налог, тыс.руб. 2023 ; Транспортный налог, тыс.руб. 2024 ; Прочие налоги 2017 ; Прочие налоги 2018 ; Прочие налоги 2019 ; Прочие налоги 2020 ; Прочие налоги 2021 ; Прочие налоги 2022 ; Прочие налоги 2023 ; Прочие налоги 2024 ; Акцизы, тыс. руб. 2017 ; Акцизы, тыс. руб. 2018 ; Акцизы, тыс. руб. 2019 ; Акцизы, тыс. руб. 2020 ; Акцизы, тыс. руб. 2021 ; Акцизы, тыс. руб. 2022 ; Акцизы, тыс. руб. 2023 ; Акцизы, тыс. руб. 2024 ; Инвестиции в Мск 2021 тыс. руб. ; Инвестиции в Мск 2022 тыс. руб. ; Инвестиции в Мск 2023 тыс. руб. ; Объем экспорта, тыс. руб. 2019 ; Объем экспорта, тыс. руб. 2020 ; Объем экспорта, тыс. руб. 2021 ; Объем экспорта, тыс. руб. 2022 ; Объем экспорта, тыс. руб. 2023 ;Имущественно-земельный комплекс;Кадастровый номер ЗУ;Площадь ЗУ;Вид разрешенного использования ЗУ;Вид собственности ЗУ;Собственник ЗУ;Кадастровый номер ОКСа;Площадь ОКСов;Вид разрешенного использования ОКСов;Тип строения и цель использования;Вид собственности ОКСов;СобственникОКСов;Площадь производственных помещений, кв.м.;Производимая продукция;Стандартизированная продукция;Название (виды производимой продукции);Перечень производимой продукции по кодам ОКПД 2;Перечень производимой продукции по типам и сегментам;Каталог продукции;Наличие  госзаказа;Уровень загрузки производственных мощностей;Наличие поставок продукции на экспорт ;Объем экспорта (млн.руб.) за предыдущий календарный год;Перечень государств куда экспортируется продукция ;Код ТН ВЭД ЕАЭС;Развитие Реестра;Отрасль промышленности по Спарк и Справочнику;Координаты юридического адреса;Координаты адреса производства;Координаты адреса дополнительной площадки;Координаты (широта);Координаты (долгота);Округ;Район"""

headers = [h.strip() for h in headers_text.split(';')]
row_values = sample_row.split(';')

print(f"Количество заголовков: {len(headers)}")
print(f"Количество значений в строке: {len(row_values)}")
print()

# Create dict from row
data = dict(zip(headers, row_values))

# Check specific financial columns
print("=== ФИНАНСОВЫЕ ПОКАЗАТЕЛИ ===")
for year in [2017, 2018, 2019, 2020, 2021, 2022, 2023]:
    revenue_col = f'Выручка предприятия, тыс. руб. {year}'
    revenue_val = data.get(revenue_col, 'NOT_FOUND')
    print(f"{year}: Выручка = '{revenue_val}'")

print("\n=== ФОТ МОСКВЫ (с двойным пробелом) ===")
for year in [2017, 2018, 2019]:
    fot_col = f'Фонд оплаты труда  сотрудников, работающих в Москве, тыс. руб {year}'
    fot_val = data.get(fot_col, 'NOT_FOUND')
    print(f"{year}: ФОТ Москвы = '{fot_val}'")

print("\n=== СРЕДНЯЯ ЗП (с двойным пробелом) ===")
for year in [2017, 2018, 2019]:
    sal_col = f'Средняя з.п. всех сотрудников организации,  тыс.руб. {year}'
    sal_val = data.get(sal_col, 'NOT_FOUND')
    print(f"{year}: Средняя ЗП всех = '{sal_val}'")

print("\n=== НАЛОГИ ===")
for year in [2017, 2018, 2019]:
    tax_col = f'Налоги, уплаченные в бюджет Москвы (без акцизов), тыс.руб. {year}'
    tax_val = data.get(tax_col, 'NOT_FOUND')
    print(f"{year}: Налоги = '{tax_val}'")

print("\n=== ПРОБЛЕМНЫЕ СТОЛБЦЫ ===")
# Find columns that might have issues
problematic = []
for header in headers:
    if header.strip() == '':
        problematic.append(f"Пустой заголовок на позиции {headers.index(header)}")
    if '  ' in header:  # double space
        problematic.append(f"Двойной пробел: '{header}'")

for p in problematic:
    print(p)

print(f"\n=== КЛЮЧЕВЫЕ ДАННЫЕ ===")
print(f"ИНН: {data.get('ИНН')}")
print(f"Название: {data.get('Наименование организации')}")
print(f"Выручка 2023: {data.get('Выручка предприятия, тыс. руб. 2023')}")
