"""Analyze exact column mapping from Excel headers."""

headers_text = """№;ИНН;Наименование организации;Полное наименование организации;Статус СПАРК;Статус внутренний;Статус ИТОГ;Дата добавления в реестр;Юридический адрес;Адрес производства;Адрес дополнительной площадки;Основная отрасль;Подотрасль (Основная);Дополнительная отрасль;Подотрасль (Дополнительная);Отраслевые презентации;Основной ОКВЭД (СПАРК);Вид деятельности по основному ОКВЭД (СПАРК);Производственный ОКВЭД;Вид деятельности по производственному ОКВЭД;Общие сведения об организации;Размер предприятия (итог);Размер предприятия (итог) 2022;Размер предприятия (по численности);Размер предприятия (по численности) 2022;Размер предприятия (по выручке);Размер предприятия (по выручке) 2022;Дата регистрации;Руководитель;Головная организация;ИНН головной организации;Вид отношения головной организации;Контактные данные руководства;Почта руководства;Контакт сотрудника организации;Номер телефона;Контактные данные ответственного по ЧС;Сайт;Электронная почта;Данные о мерах поддержки;Наличие особого статуса;Площадка итог;Получена поддержка от г. Москвы;Системообразующее предприятие;Статус МСП;То самое ;Финансово-экономические показатели; Выручка предприятия, тыс. руб. 2017 ; Выручка предприятия, тыс. руб. 2018 ; Выручка предприятия, тыс. руб. 2019 ; Выручка предприятия, тыс. руб. 2020 ; Выручка предприятия, тыс. руб. 2021 ; Выручка предприятия, тыс. руб. 2022 ;Выручка предприятия, тыс. руб. 2023; Чистая прибыль (убыток),тыс. руб. 2017 ; Чистая прибыль (убыток),тыс. руб. 2018 ; Чистая прибыль (убыток),тыс. руб. 2019 ; Чистая прибыль (убыток),тыс. руб. 2020 ; Чистая прибыль (убыток),тыс. руб. 2021 ; Чистая прибыль (убыток),тыс. руб. 2022 ; Чистая прибыль (убыток),тыс. руб. 2023 ; Среднесписочная численность персонала (всего по компании), чел 2017 ; Среднесписочная численность персонала (всего по компании), чел 2018 ; Среднесписочная численность персонала (всего по компании), чел 2019 ; Среднесписочная численность персонала (всего по компании), чел 2020 ; Среднесписочная численность персонала (всего по компании), чел 2021 ; Среднесписочная численность персонала (всего по компании), чел 2022 ; Среднесписочная численность персонала (всего по компании), чел 2023 ; Среднесписочная численность персонала, работающего в Москве, чел 2017 ; Среднесписочная численность персонала, работающего в Москве, чел 2018 ; Среднесписочная численность персонала, работающего в Москве, чел 2019 ; Среднесписочная численность персонала, работающего в Москве, чел 2020 ; Среднесписочная численность персонала, работающего в Москве, чел 2021 ; Среднесписочная численность персонала, работающего в Москве, чел 2022 ; Среднесписочная численность персонала, работающего в Москве, чел 2023 ; Фонд оплаты труда всех сотрудников организации, тыс. руб 2017 ; Фонд оплаты труда всех сотрудников организации, тыс. руб 2018 ; Фонд оплаты труда всех сотрудников организации, тыс. руб 2019 ; Фонд оплаты труда всех сотрудников организации, тыс. руб 2020 ; Фонд оплаты труда всех сотрудников организации, тыс. руб 2021 ; Фонд оплаты труда всех сотрудников организации, тыс. руб 2022 ; Фонд оплаты труда всех сотрудников организации, тыс. руб 2023 ; Фонд оплаты труда  сотрудников, работающих в Москве, тыс. руб 2017 ; Фонд оплаты труда  сотрудников, работающих в Москве, тыс. руб 2018 ; Фонд оплаты труда  сотрудников, работающих в Москве, тыс. руб 2019 ; Фонд оплаты труда  сотрудников, работающих в Москве, тыс. руб 2020 ; Фонд оплаты труда  сотрудников, работающих в Москве, тыс. руб. 2021 ; Фонд оплаты труда  сотрудников, работающих в Москве, тыс. руб. 2022 ; Фонд оплаты труда  сотрудников, работающих в Москве, тыс. руб. 2023 ; Средняя з.п. всех сотрудников организации,  тыс.руб. 2017 ; Средняя з.п. всех сотрудников организации,  тыс.руб. 2018 ; Средняя з.п. всех сотрудников организации,  тыс.руб. 2019 ; Средняя з.п. всех сотрудников организации,  тыс.руб. 2020 ; Средняя з.п. всех сотрудников организации,  тыс.руб. 2021 ; Средняя з.п. всех сотрудников организации,  тыс.руб. 2022 ; Средняя з.п. всех сотрудников организации,  тыс.руб. 2023 ; Средняя з.п. сотрудников, работающих в Москве,  тыс.руб. 2017 ; Средняя з.п. сотрудников, работающих в Москве,  тыс.руб. 2018 ; Средняя з.п. сотрудников, работающих в Москве,  тыс.руб. 2019 ; Средняя з.п. сотрудников, работающих в Москве,  тыс.руб. 2020 ; Средняя з.п. сотрудников, работающих в Москве,  тыс.руб. 2021 ; Средняя з.п. сотрудников, работающих в Москве,  тыс.руб. 2022 ; Средняя з.п. сотрудников, работающих в Москве,  тыс.руб. 2023 ; Налоги, уплаченные в бюджет Москвы (без акцизов), тыс.руб. 2017 ; Налоги, уплаченные в бюджет Москвы (без акцизов), тыс.руб. 2018 ; Налоги, уплаченные в бюджет Москвы (без акцизов), тыс.руб. 2019 ; Налоги, уплаченные в бюджет Москвы (без акцизов), тыс.руб. 2020 ; Налоги, уплаченные в бюджет Москвы (без акцизов), тыс.руб. 2021 ; Налоги, уплаченные в бюджет Москвы (без акцизов), тыс.руб. 2022 ; Налоги, уплаченные в бюджет Москвы (без акцизов), тыс.руб. 2023 ; Налоги, уплаченные в бюджет Москвы (без акцизов), тыс.руб. 2024 ; Налог на прибыль, тыс.руб. 2017 ; Налог на прибыль, тыс.руб. 2018 ; Налог на прибыль, тыс.руб. 2019 ; Налог на прибыль, тыс.руб. 2020 ; Налог на прибыль, тыс.руб. 2021 ; Налог на прибыль, тыс.руб. 2022 ; Налог на прибыль, тыс.руб. 2023 ; Налог на прибыль, тыс.руб. 2024 ; Налог на имущество, тыс.руб. 2017 ; Налог на имущество, тыс.руб. 2018 ; Налог на имущество, тыс.руб. 2019 ; Налог на имущество, тыс.руб. 2020 ; Налог на имущество, тыс.руб. 2021 ; Налог на имущество, тыс.руб. 2022 ; Налог на имущество, тыс.руб. 2023 ; Налог на имущество, тыс.руб. 2024 ; Налог на землю, тыс.руб. 2017 ; Налог на землю, тыс.руб. 2018 ; Налог на землю, тыс.руб. 2019 ; Налог на землю, тыс.руб. 2020 ; Налог на землю, тыс.руб. 2021 ; Налог на землю, тыс.руб. 2022 ; Налог на землю, тыс.руб. 2023 ; Налог на землю, тыс.руб. 2024 ; НДФЛ, тыс.руб. 2017 ; НДФЛ, тыс.руб. 2018 ; НДФЛ, тыс.руб. 2019 ; НДФЛ, тыс.руб. 2020 ; НДФЛ, тыс.руб. 2021 ; НДФЛ, тыс.руб. 2022 ; НДФЛ, тыс.руб. 2023 ; НДФЛ, тыс.руб. 2024 ; Транспортный налог, тыс.руб. 2017 ; Транспортный налог, тыс.руб. 2018 ; Транспортный налог, тыс.руб. 2019 ; Транспортный налог, тыс.руб. 2020 ; Транспортный налог, тыс.руб. 2021 ; Транспортный налог, тыс.руб. 2022 ; Транспортный налог, тыс.руб. 2023 ; Транспортный налог, тыс.руб. 2024 ; Прочие налоги 2017 ; Прочие налоги 2018 ; Прочие налоги 2019 ; Прочие налоги 2020 ; Прочие налоги 2021 ; Прочие налоги 2022 ; Прочие налоги 2023 ; Прочие налоги 2024 ; Акцизы, тыс. руб. 2017 ; Акцизы, тыс. руб. 2018 ; Акцизы, тыс. руб. 2019 ; Акцизы, тыс. руб. 2020 ; Акцизы, тыс. руб. 2021 ; Акцизы, тыс. руб. 2022 ; Акцизы, тыс. руб. 2023 ; Акцизы, тыс. руб. 2024 ; Инвестиции в Мск 2021 тыс. руб. ; Инвестиции в Мск 2022 тыс. руб. ; Инвестиции в Мск 2023 тыс. руб. ; Объем экспорта, тыс. руб. 2019 ; Объем экспорта, тыс. руб. 2020 ; Объем экспорта, тыс. руб. 2021 ; Объем экспорта, тыс. руб. 2022 ; Объем экспорта, тыс. руб. 2023 ;Имущественно-земельный комплекс;Кадастровый номер ЗУ;Площадь ЗУ;Вид разрешенного использования ЗУ;Вид собственности ЗУ;Собственник ЗУ;Кадастровый номер ОКСа;Площадь ОКСов;Вид разрешенного использования ОКСов;Тип строения и цель использования;Вид собственности ОКСов;СобственникОКСов;Площадь производственных помещений, кв.м.;Производимая продукция;Стандартизированная продукция;Название (виды производимой продукции);Перечень производимой продукции по кодам ОКПД 2;Перечень производимой продукции по типам и сегментам;Каталог продукции;Наличие  госзаказа;Уровень загрузки производственных мощностей;Наличие поставок продукции на экспорт ;Объем экспорта (млн.руб.) за предыдущий календарный год;Перечень государств куда экспортируется продукция ;Код ТН ВЭД ЕАЭС;Развитие Реестра;Отрасль промышленности по Спарк и Справочнику;Координаты юридического адреса;Координаты адреса производства;Координаты адреса дополнительной площадки;Координаты (широта);Координаты (долгота);Округ;Район"""

sample_row = """20;7706901234;ООО "СВЕТОТЕХНИКА";ОБЩЕСТВО С ОГРАНИЧЕННОЙ ОТВЕТСТВЕННОСТЬЮ "СВЕТОТЕХНИКА";Действующее;Активное;Действующее;30.06.2022;г. Москва, ул. Ивантеевская, д. 23;г. Москва, ул. Ивантеевская, д. 23;;Электротехника;Производство светотехнической продукции;Электротехника;Производство светильников;Имеется;27.40;Производство электрических ламп и осветительного оборудования;27.40.1;Производство электрических ламп и источников света;Производство светодиодных светильников и ламп для промышленного и бытового применения;Среднее;Среднее;Среднее;Среднее;Среднее;Среднее;13.04.2012;Куликов Андрей Николаевич;ГК "ЭЛЕКТРОСВЕТ";7702345678;Дочернее общество;+7 (495) 612-45-78;kulikov.an@svetotekhnika.ru;Яковлев Максим Игоревич, инженер-электрик;+7 (495) 612-45-79;+7 (495) 612-45-80, Семенов П.К.;www.svetotekhnika-led.ru;info@svetotekhnika.ru;Субсидия на НИОКР 2023;Энергоэффективность А++;Собственная;Да;Нет;Да;Контракт с ЖКХ Москвы;;645670;734560;845670;778900;945670;1123450;1334560;67890;82340;101230;89670;118900;145670;178900;223;245;267;256;289;312;345;223;245;267;256;289;312;345;156780;189340;223450;212340;256780;301340;356780;156780;189340;223450;212340;256780;301340;356780;58.6;64.4;69.7;69.1;74.0;80.5;86.2;58.6;64.4;69.7;69.1;74.0;80.5;86.2;71230;84560;101230;93450;112340;134560;159670;189670;13578;16468;20246;17934;23780;29134;35780;42340;4890;5230;5560;5890;6340;6780;7230;7680;2450;2580;2690;2810;3010;3210;3410;3610;48670;58890;70560;65340;79450;93450;109670;129890;289;334;378;423;478;534;589;645;644;868;1126;1353;1843;2131;2660;2986;0;0;0;0;0;0;0;0;56780;73450;94560;89670;108900;134560;159670;189670;Производственная база;77:11:0005078:2456;9670;Производственная деятельность;Собственность;ООО "СВЕТОТЕХНИКА";77:11:0005078:3789;7890;Производственное здание;Производственный цех;Собственность;ООО "СВЕТОТЕХНИКА";6340;Светодиодные лампы, LED светильники, прожекторы, уличные фонари, ленты LED;ГОСТ Р 54815-2011;Лампы LED E27, светильники офисные, прожекторы светодиодные, светильники уличные;27.40.11.110, 27.40.12.110, 27.40.32.110;Светотехническая продукция / LED лампы / Светильники / Прожекторы;Имеется;Да;75%;Да;189.67;Беларусь, Казахстан, Армения, Киргизия, Узбекистан;8539 50, 9405 10, 9405 40;Активное участие;Электротехника;55.867890, 37.645678;55.867890, 37.645678;;55.867890;37.645678;СВАО;Ростокино"""

headers = headers_text.split(';')
values = sample_row.split(';')

print(f"Всего заголовков: {len(headers)}")
print(f"Всего значений: {len(values)}")
print()

# Find financial columns
print("=== ФИНАНСОВЫЕ СТОЛБЦЫ (индекс: заголовок = значение) ===\n")

financial_start_idx = None
for i, h in enumerate(headers):
    if 'Выручка предприятия, тыс. руб. 2017' in h:
        financial_start_idx = i
        break

if financial_start_idx:
    print(f"Финансы начинаются с индекса: {financial_start_idx}")
    print(f"Заголовок: '{headers[financial_start_idx]}'")
    print(f"Значение: '{values[financial_start_idx] if financial_start_idx < len(values) else 'ОТСУТСТВУЕТ'}'")
    print()
    
    # Show revenue columns 2017-2023
    print("ВЫРУЧКА:")
    for year in range(2017, 2024):
        for i, h in enumerate(headers):
            if f'Выручка предприятия, тыс. руб. {year}' in h:
                val = values[i] if i < len(values) else 'НЕТ'
                print(f"  [{i:3d}] {year}: {h.strip():<60} = '{val}'")
                break
    
    print("\nПРИБЫЛЬ:")
    for year in range(2017, 2024):
        for i, h in enumerate(headers):
            if f'Чистая прибыль (убыток),тыс. руб. {year}' in h:
                val = values[i] if i < len(values) else 'НЕТ'
                print(f"  [{i:3d}] {year}: {h.strip():<60} = '{val}'")
                break
    
    print("\nЧИСЛЕННОСТЬ ВСЕГО:")
    for year in range(2017, 2024):
        for i, h in enumerate(headers):
            if f'Среднесписочная численность персонала (всего по компании), чел {year}' in h:
                val = values[i] if i < len(values) else 'НЕТ'
                print(f"  [{i:3d}] {year}: {h.strip():<80} = '{val}'")
                break

print("\n=== ПРОВЕРКА ДВОЙНЫХ ПРОБЕЛОВ ===")
for i, h in enumerate(headers):
    if '  ' in h:
        val = values[i] if i < len(values) else 'НЕТ'
        print(f"[{i:3d}] '{h}' = '{val}'")
