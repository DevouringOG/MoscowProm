<!DOCTYPE html>
<html lang="ru">
<head>
 <meta charset="UTF-8">
 <meta name="viewport" content="width=device-width, initial-scale=1.0">
 <title>{{ org.name }} - MosProm</title>
 <link rel="stylesheet" href="/static/css/main.css">
 <style>
 * {
 margin: 0;
 padding: 0;
 box-sizing: border-box;
 }

 body {
 font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
 background: var(--accent-dark);
 min-height: 100vh;
 padding: 20px;
 }

 .container {
 max-width: 1400px;
 margin: 0 auto;
 background: var(--card-bg);box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
 overflow: hidden;
 }

 .header {
 background: var(--accent-dark);
 color: var(--card-bg);
 padding: 30px;
 }

 .header-actions {
 display: flex;
 gap: 10px;
 margin-bottom: 20px;
 flex-wrap: wrap;
 }

 .back-btn,
 .edit-btn,
 .delete-btn,
 .fns-btn,
 .import-btn {
 display: inline-flex;
 align-items: center;
 gap: 8px;
 color: var(--card-bg);
 text-decoration: none;
 padding: 8px 16px;
 background: rgba(255, 255, 255, 0.2);transition: background 0.3s ease;
 border: none;
 cursor: pointer;
 font-size: 14px;
 }

 .back-btn:hover,
 .edit-btn:hover,
 .fns-btn:hover,
 .import-btn:hover {
 background: rgba(255, 255, 255, 0.3);
 }

 .fns-btn {
 background: rgba(0, 123, 255, 0.8);
 }

 .fns-btn:hover {
 background: rgba(0, 123, 255, 1);
 }

 .fns-btn:disabled {
 opacity: 0.5;
 cursor: not-allowed;
 }

 .import-btn {
 background: rgba(40, 167, 69, 0.8);
 }

 .import-btn:hover {
 background: rgba(40, 167, 69, 1);
 }

 .import-btn:disabled {
 opacity: 0.5;
 cursor: not-allowed;
 }

 .delete-btn {
 background: rgba(220, 53, 69, 0.8);
 }

 .delete-btn:hover {
 background: rgba(220, 53, 69, 1);
 }

 .org-title {
 font-size: 32px;
 font-weight: 600;
 margin-bottom: 10px;
 }

 .org-subtitle {
 display: flex;
 gap: 20px;
 align-items: center;
 flex-wrap: wrap;
 }

 .inn-badge {
 background: rgba(255, 255, 255, 0.3);
 padding: 6px 16px;font-family: 'Courier New', monospace;
 font-size: 14px;
 }

 .tabs {
 display: flex;
 background: var(--accent-light);
 border-bottom: 2px solid #dee2e6;
 overflow-x: auto;
 }

 .tab {
 padding: 16px 24px;
 background: transparent;
 border: none;
 cursor: pointer;
 font-size: 15px;
 font-weight: 500;
 color: var(--text-secondary);
 white-space: nowrap;
 transition: all 0.3s ease;
 border-bottom: 3px solid transparent;
 }

 .tab:hover {
 color: var(--accent-dark);
 background: rgba(102, 126, 234, 0.05);
 }

 .tab.active {
 color: var(--accent-dark);
 border-bottom-color: var(--accent-dark);
 background: var(--card-bg);
 }

 .tab-content {
 display: none;
 padding: 30px;
 animation: fadeIn 0.3s ease;
 }

 .tab-content.active {
 display: block;
 }

 @keyframes fadeIn {
 from { opacity: 0;}
 to { opacity: 1;}
 }

 .info-grid {
 display: grid;
 grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
 gap: 20px;
 margin-bottom: 30px;
 }

 .info-card {
 background: var(--accent-light);
 padding: 20px;border-left: 4px solid #667eea;
 }

 .info-label {
 color: var(--text-secondary);
 font-size: 13px;
 font-weight: 500;
 margin-bottom: 8px;
 text-transform: uppercase;
 letter-spacing: 0.5px;
 }

 .info-value {
 color: #212529;
 font-size: 16px;
 font-weight: 500;
 }

 .info-value.large {
 font-size: 24px;
 color: var(--accent-dark);
 }

 .table-responsive {
 overflow-x: auto;
 margin-top: 20px;
 }

 table {
 width: 100%;
 border-collapse: collapse;
 background: var(--card-bg);
 }

 thead {
 background: var(--accent-light);
 }

 th {
 padding: 12px;
 text-align: left;
 font-weight: 600;
 color: var(--text-secondary);
 border-bottom: 2px solid #dee2e6;
 font-size: 13px;
 }

 td {
 padding: 12px;
 border-bottom: 1px solid #e9ecef;
 font-size: 14px;
 }

 tbody tr:hover {
 background: var(--accent-light);
 }

 .section-title {
 font-size: 20px;
 font-weight: 600;
 color: #212529;
 margin-bottom: 20px;
 padding-bottom: 10px;
 border-bottom: 2px solid #e9ecef;
 }

 .no-data {
 text-align: center;
 padding: 40px;
 color: var(--text-secondary);
 font-size: 16px;
 }

 .badge {
 display: inline-block;
 padding: 4px 12px;font-size: 12px;
 font-weight: 500;
 }

 .badge-success {
 background: #d4edda;
 color: #155724;
 }

 .badge-danger {
 background: #f8d7da;
 color: #721c24;
 }

 .badge-info {
 background: #d1ecf1;
 color: #0c5460;
 }

 .metric-highlight {
 background: var(--accent-dark);
 color: var(--card-bg);
 padding: 20px;margin-bottom: 20px;
 }

 .metric-row {
 display: flex;
 justify-content: space-between;
 align-items: center;
 margin-bottom: 10px;
 }

 .metric-row:last-child {
 margin-bottom: 0;
 }
</style>
</head>
<body>
 <div class="container">
 <div class="header">
 <div class="header-actions">
 <a href="/organizations" class="back-btn">‚Üê –ù–∞–∑–∞–¥ –∫ —Å–ø–∏—Å–∫—É</a>
 <a href="/organizations/{{ org.id }}/analytics" class="edit-btn">–ê–Ω–∞–ª–∏—Ç–∏–∫–∞</a>
 <a href="/organizations/{{ org.id }}/edit" class="edit-btn">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</a>
 <button onclick="updateFromFNS()" class="fns-btn" id="fnsBtn">‚ü≥ –û–ë–ù–û–í–ò–¢–¨ –ò–ó –§–ù–°</button>
 <button onclick="importFinancials()" class="import-btn" id="importBtn">üìä –ò–ú–ü–û–†–¢ –ë–£–•–û–¢–ß–Å–¢–ù–û–°–¢–ò</button>
 <button onclick="deleteOrganization()" class="delete-btn"> –£–¥–∞–ª–∏—Ç—å</button>
</div>
 <h1 class="org-title">{{ org.name }}</h1>
 <div class="org-subtitle">
 <span class="inn-badge">–ò–ù–ù: {{ org.inn }}</span>
 {% if org.status_final %}
 <span>{{ org.status_final }}</span>
 {% endif %}
</div>
</div>

 <div class="tabs">
 <button class="tab active" onclick="showTab('general')">–û–±—â–∏–µ –¥–∞–Ω–Ω—ã–µ</button>
 <button class="tab" onclick="showTab('metrics')">–§–∏–Ω–∞–Ω—Å–æ–≤—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏</button>
 <button class="tab" onclick="showTab('taxes')">–ù–∞–ª–æ–≥–∏</button>
 <button class="tab" onclick="showTab('assets')"> –ò–º—É—â–µ—Å—Ç–≤–æ</button>
 <button class="tab" onclick="showTab('products')"> –ü—Ä–æ–¥—É–∫—Ü–∏—è</button>
 <button class="tab" onclick="showTab('contacts')"> –ö–æ–Ω—Ç–∞–∫—Ç—ã</button>
</div>

 <!-- –û–±—â–∏–µ –¥–∞–Ω–Ω—ã–µ -->
 <div id="general" class="tab-content active">
 <h2 class="section-title">–û—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h2>
 <div class="info-grid">
 <div class="info-card">
 <div class="info-label">–ü–æ–ª–Ω–æ–µ –Ω–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ</div>
 <div class="info-value">{{ org.full_name or '‚Äî' }}</div>
</div>
 <div class="info-card">
 <div class="info-label">–ò–ù–ù</div>
 <div class="info-value large">{{ org.inn }}</div>
</div>
 <div class="info-card">
 <div class="info-label">–°—Ç–∞—Ç—É—Å</div>
 <div class="info-value">{{ org.status_final or org.status_spark or '‚Äî' }}</div>
</div>
 <div class="info-card">
 <div class="info-label">–î–∞—Ç–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏</div>
 <div class="info-value">{{ org.registration_date.strftime('%d.%m.%Y') if org.registration_date else '‚Äî' }}</div>
</div>
 <div class="info-card">
 <div class="info-label">–û—Å–Ω–æ–≤–Ω–∞—è –æ—Ç—Ä–∞—Å–ª—å</div>
 <div class="info-value">{{ org.main_industry or '‚Äî' }}</div>
</div>
 <div class="info-card">
 <div class="info-label">–ü–æ–¥–æ—Ç—Ä–∞—Å–ª—å</div>
 <div class="info-value">{{ org.main_subindustry or '‚Äî' }}</div>
</div>
 <div class="info-card">
 <div class="info-label">–†–∞–∑–º–µ—Ä –ø—Ä–µ–¥–ø—Ä–∏—è—Ç–∏—è</div>
 <div class="info-value">{{ org.company_size or org.company_size_2022 or '‚Äî' }}</div>
</div>
 <div class="info-card">
 <div class="info-label">–°—Ç–∞—Ç—É—Å –ú–°–ü</div>
 <div class="info-value">{{ org.msp_status or '‚Äî' }}</div>
</div>
 <div class="info-card">
 <div class="info-label">–†—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—å</div>
 <div class="info-value">{{ org.head_name or '‚Äî' }}</div>
</div>
 <div class="info-card">
 <div class="info-label">–û–∫—Ä—É–≥</div>
 <div class="info-value">{{ org.district or '‚Äî' }}</div>
</div>
 <div class="info-card">
 <div class="info-label">–†–∞–π–æ–Ω</div>
 <div class="info-value">{{ org.region or '‚Äî' }}</div>
</div>
 <div class="info-card">
 <div class="info-label">–°–∏—Å—Ç–µ–º–æ–æ–±—Ä–∞–∑—É—é—â–µ–µ</div>
 <div class="info-value">
 {% if org.is_system_critical %}
 <span class="badge badge-success">–î–∞</span>
 {% else %}
 <span class="badge badge-info">–ù–µ—Ç</span>
 {% endif %}
</div>
</div>
</div>

 <h2 class="section-title">–ê–¥—Ä–µ—Å–∞</h2>
 <div class="info-grid">
 <div class="info-card">
 <div class="info-label">–Æ—Ä–∏–¥–∏—á–µ—Å–∫–∏–π –∞–¥—Ä–µ—Å</div>
 <div class="info-value">{{ org.legal_address or '‚Äî' }}</div>
</div>
 <div class="info-card">
 <div class="info-label">–ê–¥—Ä–µ—Å –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–∞</div>
 <div class="info-value">{{ org.production_address or '‚Äî' }}</div>
</div>
 {% if org.additional_address %}
 <div class="info-card">
 <div class="info-label">–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –ø–ª–æ—â–∞–¥–∫–∞</div>
 <div class="info-value">{{ org.additional_address }}</div>
</div>
 {% endif %}
</div>

 <h2 class="section-title">–û–ö–í–≠–î</h2>
 <div class="info-grid">
 <div class="info-card">
 <div class="info-label">–û—Å–Ω–æ–≤–Ω–æ–π –û–ö–í–≠–î</div>
 <div class="info-value">{{ org.main_okved or '‚Äî' }}</div>
 <div style="font-size: 13px; color: var(--text-secondary); margin-top: 5px;">
 {{ org.main_okved_name or '' }}
</div>
</div>
 <div class="info-card">
 <div class="info-label">–ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–µ–Ω–Ω—ã–π –û–ö–í–≠–î</div>
 <div class="info-value">{{ org.prod_okved or '‚Äî' }}</div>
 <div style="font-size: 13px; color: var(--text-secondary); margin-top: 5px;">
 {{ org.prod_okved_name or '' }}
</div>
</div>
</div>
</div>

 <!-- –§–∏–Ω–∞–Ω—Å–æ–≤—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ -->
 <div id="metrics" class="tab-content">
 <h2 class="section-title">–§–∏–Ω–∞–Ω—Å–æ–≤–æ-—ç–∫–æ–Ω–æ–º–∏—á–µ—Å–∫–∏–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ –ø–æ –≥–æ–¥–∞–º</h2>
 {% if metrics %}
 <div class="table-responsive">
 <table>
 <thead>
 <tr>
 <th>–ì–æ–¥</th>
 <th>–í—ã—Ä—É—á–∫–∞, —Ç—ã—Å.‚ÇΩ</th>
 <th>–ü—Ä–∏–±—ã–ª—å, —Ç—ã—Å.‚ÇΩ</th>
 <th>–ß–∏—Å–ª–µ–Ω–Ω–æ—Å—Ç—å (–≤—Å–µ–≥–æ)</th>
 <th>–ß–∏—Å–ª–µ–Ω–Ω–æ—Å—Ç—å (–ú–°–ö)</th>
 <th>–§–û–¢ (–≤—Å–µ–≥–æ), —Ç—ã—Å.‚ÇΩ</th>
 <th>–§–û–¢ (–ú–°–ö), —Ç—ã—Å.‚ÇΩ</th>
 <th>–ò–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏, —Ç—ã—Å.‚ÇΩ</th>
 <th>–≠–∫—Å–ø–æ—Ä—Ç, —Ç—ã—Å.‚ÇΩ</th>
</tr>
</thead>
 <tbody>
 {% for m in metrics %}
 <tr>
 <td><strong>{{ m.year }}</strong></td>
 <td>{{ '{:,.0f}'.format(m.revenue).replace(',', ' ') if m.revenue else '‚Äî' }}</td>
 <td>{{ '{:,.0f}'.format(m.profit).replace(',', ' ') if m.profit else '‚Äî' }}</td>
 <td>{{ m.total_employees or '‚Äî' }}</td>
 <td>{{ m.moscow_employees or '‚Äî' }}</td>
 <td>{{ '{:,.0f}'.format(m.total_fot).replace(',', ' ') if m.total_fot else '‚Äî' }}</td>
 <td>{{ '{:,.0f}'.format(m.moscow_fot).replace(',', ' ') if m.moscow_fot else '‚Äî' }}</td>
 <td>{{ '{:,.0f}'.format(m.investments).replace(',', ' ') if m.investments else '‚Äî' }}</td>
 <td>{{ '{:,.0f}'.format(m.export_volume).replace(',', ' ') if m.export_volume else '‚Äî' }}</td>
</tr>
 {% endfor %}
</tbody>
</table>
</div>
 {% else %}
 <div class="no-data">–§–∏–Ω–∞–Ω—Å–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç</div>
 {% endif %}
</div>

 <!-- –ù–∞–ª–æ–≥–∏ -->
 <div id="taxes" class="tab-content">
 <h2 class="section-title">–ù–∞–ª–æ–≥–∏, —É–ø–ª–∞—á–µ–Ω–Ω—ã–µ –≤ –±—é–¥–∂–µ—Ç –ú–æ—Å–∫–≤—ã</h2>
 {% if taxes %}
 <div class="table-responsive">
 <table>
 <thead>
 <tr>
 <th>–ì–æ–¥</th>
 <th>–í—Å–µ–≥–æ (–±–µ–∑ –∞–∫—Ü–∏–∑–æ–≤)</th>
 <th>–ù–∞–ª–æ–≥ –Ω–∞ –ø—Ä–∏–±—ã–ª—å</th>
 <th>–ù–∞–ª–æ–≥ –Ω–∞ –∏–º—É—â–µ—Å—Ç–≤–æ</th>
 <th>–ù–∞–ª–æ–≥ –Ω–∞ –∑–µ–º–ª—é</th>
 <th>–ù–î–§–õ</th>
 <th>–¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω—ã–π</th>
 <th>–ü—Ä–æ—á–∏–µ</th>
 <th>–ê–∫—Ü–∏–∑—ã</th>
</tr>
</thead>
 <tbody>
 {% for t in taxes %}
 <tr>
 <td><strong>{{ t.year }}</strong></td>
 <td>{{ '{:,.0f}'.format(t.total_taxes_moscow).replace(',', ' ') if t.total_taxes_moscow else '‚Äî' }}</td>
 <td>{{ '{:,.0f}'.format(t.profit_tax).replace(',', ' ') if t.profit_tax else '‚Äî' }}</td>
 <td>{{ '{:,.0f}'.format(t.property_tax).replace(',', ' ') if t.property_tax else '‚Äî' }}</td>
 <td>{{ '{:,.0f}'.format(t.land_tax).replace(',', ' ') if t.land_tax else '‚Äî' }}</td>
 <td>{{ '{:,.0f}'.format(t.ndfl).replace(',', ' ') if t.ndfl else '‚Äî' }}</td>
 <td>{{ '{:,.0f}'.format(t.transport_tax).replace(',', ' ') if t.transport_tax else '‚Äî' }}</td>
 <td>{{ '{:,.0f}'.format(t.other_taxes).replace(',', ' ') if t.other_taxes else '‚Äî' }}</td>
 <td>{{ '{:,.0f}'.format(t.excise).replace(',', ' ') if t.excise else '‚Äî' }}</td>
</tr>
 {% endfor %}
</tbody>
</table>
</div>
 {% else %}
 <div class="no-data">–ù–∞–ª–æ–≥–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç</div>
 {% endif %}
</div>

 <!-- –ò–º—É—â–µ—Å—Ç–≤–æ -->
 <div id="assets" class="tab-content">
 <h2 class="section-title">–ò–º—É—â–µ—Å—Ç–≤–µ–Ω–Ω–æ-–∑–µ–º–µ–ª—å–Ω—ã–π –∫–æ–º–ø–ª–µ–∫—Å</h2>
 {% if assets %}
 {% for asset in assets %}
 <div class="info-grid">
 <div class="info-card">
 <div class="info-label">–ö–∞–¥–∞—Å—Ç—Ä–æ–≤—ã–π –Ω–æ–º–µ—Ä –ó–£</div>
 <div class="info-value">{{ asset.cadastral_number_land or '‚Äî' }}</div>
</div>
 <div class="info-card">
 <div class="info-label">–ü–ª–æ—â–∞–¥—å –ó–£</div>
 <div class="info-value">{{ asset.land_area or '‚Äî' }}</div>
</div>
 <div class="info-card">
 <div class="info-label">–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ó–£</div>
 <div class="info-value">{{ asset.land_usage or '‚Äî' }}</div>
</div>
 <div class="info-card">
 <div class="info-label">–°–æ–±—Å—Ç–≤–µ–Ω–Ω–∏–∫ –ó–£</div>
 <div class="info-value">{{ asset.land_owner or '‚Äî' }}</div>
</div>
 <div class="info-card">
 <div class="info-label">–ö–∞–¥–∞—Å—Ç—Ä–æ–≤—ã–π –Ω–æ–º–µ—Ä –û–ö–°–∞</div>
 <div class="info-value">{{ asset.cadastral_number_building or '‚Äî' }}</div>
</div>
 <div class="info-card">
 <div class="info-label">–ü–ª–æ—â–∞–¥—å –û–ö–°–æ–≤</div>
 <div class="info-value">{{ asset.building_area or '‚Äî' }}</div>
</div>
 <div class="info-card">
 <div class="info-label">–¢–∏–ø —Å—Ç—Ä–æ–µ–Ω–∏—è</div>
 <div class="info-value">{{ asset.building_type or '‚Äî' }}</div>
</div>
 <div class="info-card">
 <div class="info-label">–ü–ª–æ—â–∞–¥—å –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–µ–Ω–Ω—ã—Ö –ø–æ–º–µ—â–µ–Ω–∏–π</div>
 <div class="info-value">{{ asset.production_area or '‚Äî' }} –∫–≤.–º</div>
</div>
</div>
 {% endfor %}
 {% else %}
 <div class="no-data"> –î–∞–Ω–Ω—ã–µ –æ–± –∏–º—É—â–µ—Å—Ç–≤–µ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç</div>
 {% endif %}
</div>

 <!-- –ü—Ä–æ–¥—É–∫—Ü–∏—è -->
 <div id="products" class="tab-content">
 <h2 class="section-title">–ü—Ä–æ–∏–∑–≤–æ–¥–∏–º–∞—è –ø—Ä–æ–¥—É–∫—Ü–∏—è</h2>
 {% if products %}
 {% for product in products %}
 <div class="info-grid">
 <div class="info-card">
 <div class="info-label">–ü—Ä–æ–∏–∑–≤–æ–¥–∏–º–∞—è –ø—Ä–æ–¥—É–∫—Ü–∏—è</div>
 <div class="info-value">{{ product.product_name or '‚Äî' }}</div>
</div>
 <div class="info-card">
 <div class="info-label">–ö–æ–¥—ã –û–ö–ü–î 2</div>
 <div class="info-value">{{ product.okpd2_codes or '‚Äî' }}</div>
</div>
 <div class="info-card">
 <div class="info-label">–ó–∞–≥—Ä—É–∑–∫–∞ –º–æ—â–Ω–æ—Å—Ç–µ–π</div>
 <div class="info-value">{{ product.capacity_usage or '‚Äî' }}</div>
</div>
 <div class="info-card">
 <div class="info-label">–ù–∞–ª–∏—á–∏–µ —ç–∫—Å–ø–æ—Ä—Ç–∞</div>
 <div class="info-value">
 {% if product.has_export %}
 <span class="badge badge-success">–î–∞</span>
 {% else %}
 <span class="badge badge-info">–ù–µ—Ç</span>
 {% endif %}
</div>
</div>
 {% if product.has_export %}
 <div class="info-card">
 <div class="info-label">–û–±—ä–µ–º —ç–∫—Å–ø–æ—Ä—Ç–∞ (–ø—Ä–æ—à–ª—ã–π –≥–æ–¥)</div>
 <div class="info-value">{{ product.export_volume_last_year or '‚Äî' }} –º–ª–Ω.‚ÇΩ</div>
</div>
 <div class="info-card">
 <div class="info-label">–°—Ç—Ä–∞–Ω—ã —ç–∫—Å–ø–æ—Ä—Ç–∞</div>
 <div class="info-value">{{ product.export_countries or '‚Äî' }}</div>
</div>
 <div class="info-card">
 <div class="info-label">–ö–æ–¥ –¢–ù –í–≠–î –ï–ê–≠–°</div>
 <div class="info-value">{{ product.tnved_code or '‚Äî' }}</div>
</div>
 {% endif %}
</div>
 {% endfor %}
 {% else %}
 <div class="no-data"> –î–∞–Ω–Ω—ã–µ –æ –ø—Ä–æ–¥—É–∫—Ü–∏–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç</div>
 {% endif %}
</div>

 <!-- –ö–æ–Ω—Ç–∞–∫—Ç—ã -->
 <div id="contacts" class="tab-content">
 <h2 class="section-title">–ö–æ–Ω—Ç–∞–∫—Ç–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h2>
 <div class="info-grid">
 <div class="info-card">
 <div class="info-label">–†—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—å</div>
 <div class="info-value">{{ org.head_name or '‚Äî' }}</div>
</div>
 <div class="info-card">
 <div class="info-label">–¢–µ–ª–µ—Ñ–æ–Ω</div>
 <div class="info-value">{{ org.phone or '‚Äî' }}</div>
</div>
 <div class="info-card">
 <div class="info-label">Email</div>
 <div class="info-value">{{ org.email or '‚Äî' }}</div>
</div>
 <div class="info-card">
 <div class="info-label">–°–∞–π—Ç</div>
 <div class="info-value">
 {% if org.website %}
 <a href="{{ org.website }}" target="_blank" style="color: var(--accent-dark);">{{ org.website }}</a>
 {% else %}
 ‚Äî
 {% endif %}
</div>
</div>
 <div class="info-card">
 <div class="info-label">–ö–æ–Ω—Ç–∞–∫—Ç—ã —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–∞</div>
 <div class="info-value">{{ org.head_contacts or '‚Äî' }}</div>
</div>
 <div class="info-card">
 <div class="info-label">Email —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–∞</div>
 <div class="info-value">{{ org.head_email or '‚Äî' }}</div>
</div>
 <div class="info-card">
 <div class="info-label">–ö–æ–Ω—Ç–∞–∫—Ç —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞</div>
 <div class="info-value">{{ org.employee_contact or '‚Äî' }}</div>
</div>
 <div class="info-card">
 <div class="info-label">–ö–æ–Ω—Ç–∞–∫—Ç –ø–æ –ß–°</div>
 <div class="info-value">{{ org.emergency_contact or '‚Äî' }}</div>
</div>
</div>
</div>
</div>

 <script>
 function showTab(tabName) {
 // Hide all tabs
 const contents = document.querySelectorAll('.tab-content');
 contents.forEach(content => content.classList.remove('active'));

 // Deactivate all tab buttons
 const tabs = document.querySelectorAll('.tab');
 tabs.forEach(tab => tab.classList.remove('active'));

 // Show selected tab
 document.getElementById(tabName).classList.add('active');

 // Activate clicked tab button
 event.target.classList.add('active');
 }

 async function deleteOrganization() {
 if (!confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç—É –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—é?\n\n–ë—É–¥—É—Ç —É–¥–∞–ª–µ–Ω—ã –≤—Å–µ —Å–≤—è–∑–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (–ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏, –Ω–∞–ª–æ–≥–∏, –∏–º—É—â–µ—Å—Ç–≤–æ, –ø—Ä–æ–¥—É–∫—Ü–∏—è).\n\n–≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–ª—å–∑—è –æ—Ç–º–µ–Ω–∏—Ç—å!')) {
 return;
 }

 try {
 const response = await fetch('/organizations/{{ org.id }}', {
 method: 'DELETE'
 });

 if (response.ok) {
 alert('–û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è —É—Å–ø–µ—à–Ω–æ —É–¥–∞–ª–µ–Ω–∞');
 window.location.href = '/organizations';
 } else {
 const error = await response.json();
 alert('–û—à–∏–±–∫–∞ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏: ' + (error.detail || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞'));
 }
 } catch (error) {
 alert('–û—à–∏–±–∫–∞ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏: ' + error.message);
 }
 }

 async function updateFromFNS() {
 const btn = document.getElementById('fnsBtn');
 const originalText = btn.textContent;
 
 if (!confirm('–û–±–Ω–æ–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ –∏–∑ –±–∞–∑—ã –§–ù–°?\n\n–¢–µ–∫—É—â–∏–µ –¥–∞–Ω–Ω—ã–µ –±—É–¥—É—Ç –ø–µ—Ä–µ–∑–∞–ø–∏—Å–∞–Ω—ã –∞–∫—Ç—É–∞–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π.')) {
 return;
 }

 try {
 // Disable button and show loading state
 btn.disabled = true;
 btn.textContent = '‚ü≥ –ó–∞–≥—Ä—É–∑–∫–∞...';

 const response = await fetch('/organizations/{{ org.id }}/update-from-fns', {
 method: 'POST',
 headers: {
 'Content-Type': 'application/json'
 }
 });

 const data = await response.json();

 if (response.ok) {
 alert(data.message + '\n\n–û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –ø–æ–ª—è: ' + (data.updated_fields.length > 0 ? data.updated_fields.join(', ') : '–Ω–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–π'));
 // Reload page to show updated data
 window.location.reload();
 } else {
 alert('–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ –∏–∑ –§–ù–°: ' + (data.detail || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞'));
 btn.disabled = false;
 btn.textContent = originalText;
 }
 } catch (error) {
 alert('–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ –∏–∑ –§–ù–°: ' + error.message);
 btn.disabled = false;
 btn.textContent = originalText;
 }
 }

 async function importFinancials() {
 const btn = document.getElementById('importBtn');
 const originalText = btn.textContent;
 
 if (!confirm('–ò–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –±—É—Ö–≥–∞–ª—Ç–µ—Ä—Å–∫—É—é –æ—Ç—á—ë—Ç–Ω–æ—Å—Ç—å –∏–∑ –±–∞–∑—ã –§–ù–°?\n\n–î–∞–Ω–Ω—ã–µ –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–µ–Ω—ã –≤ —Ä–∞–∑–¥–µ–ª "–§–∏–Ω–∞–Ω—Å–æ–≤—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏".\n–î–æ—Å—Ç—É–ø–Ω–∞ –æ—Ç—á—ë—Ç–Ω–æ—Å—Ç—å —Å 2019 –≥–æ–¥–∞.')) {
 return;
 }

 try {
 // Disable button and show loading state
 btn.disabled = true;
 btn.textContent = '‚ü≥ –ó–∞–≥—Ä—É–∑–∫–∞...';

 const response = await fetch('/organizations/{{ org.id }}/import-financials', {
 method: 'POST',
 headers: {
 'Content-Type': 'application/json'
 }
 });

 const data = await response.json();

 if (response.ok) {
 let message = data.message + '\n\n';
 message += '–í—Å–µ–≥–æ –ø–µ—Ä–∏–æ–¥–æ–≤: ' + data.total_years;
 if (data.imported_years.length > 0) {
 message += '\n–ò–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã –≥–æ–¥—ã: ' + data.imported_years.join(', ');
 }
 if (data.updated_years.length > 0) {
 message += '\n–û–±–Ω–æ–≤–ª–µ–Ω—ã –≥–æ–¥—ã: ' + data.updated_years.join(', ');
 }
 alert(message);
 // Reload page to show updated data
 window.location.reload();
 } else {
 alert('–û—à–∏–±–∫–∞ –ø—Ä–∏ –∏–º–ø–æ—Ä—Ç–µ –±—É—Ö–æ—Ç—á—ë—Ç–Ω–æ—Å—Ç–∏: ' + (data.detail || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞'));
 btn.disabled = false;
 btn.textContent = originalText;
 }
 } catch (error) {
 alert('–û—à–∏–±–∫–∞ –ø—Ä–∏ –∏–º–ø–æ—Ä—Ç–µ –±—É—Ö–æ—Ç—á—ë—Ç–Ω–æ—Å—Ç–∏: ' + error.message);
 btn.disabled = false;
 btn.textContent = originalText;
 }
 }
</script>
</body>
</html>
